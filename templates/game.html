{% extends 'base.html' %}

{% block content %}
<div class="container-fluid">
	<div class="row">
		<div class="col-md-12">
			<h1>{{game.title}}</h1>
			<p>{{game.description}}</p>
		</div>
	</div>

	<div class="row">
		<div class="col-md-12">
			<ul class="nav nav-tabs" role="tablist">
				<li role="presentation">
					<a href="#game" aria-controls="home" role="tab" data-toggle="tab">Game</a>
				</li>
				{% if game_owner %}
				<li role="presentation">
					<a href="#players" aria-controls="home" role="tab" data-toggle="tab">Players</a>
				</li>

				<li role="presentation">
					<a href="#invitations" aria-controls="home" role="tab" data-toggle="tab">Invitations</a>
				</li>
				{% endif %}
			</ul>

			<div class="tab-content">
				<div id="game" role="tabpanel" class="tab-pane active">
					{% if not your_character %}
					<p>You need to create a character for this game</p>
					<form method="POST" action="/game/character" role="form">
						<input type="hidden" name="game_key" value="{{game.key.urlsafe()}}">

						<div class="form-group">
							<label for="char-name">Character name</label>
							<input type="text" class="form-control" id="char-name" name="name">
						</div>

						<div class="form-group">
							<label for="char-description">Describe your character briefly</label>
							<textarea  class="form-control" id="char-description" name="description">
							</textarea>
						</div>

						<button type="submit" class="btn btn-default">Create</button>
					</form>
					{% endif %}

					{% if your_character %}
					<p>You are playing:<br>{{your_character.name}}</p>
					{% endif %}


					{% if other_characters %}
					<h3>Other characters</h3>

					<ul>

					{% for character in other_characters %}
					<li>{{character.name}}</li>
					{% endfor %}

					</ul>
					{% endif %}
				</div>

				{% if game_owner %}
				<div id="players" role="tabpanel" class="tab-pane">
					<h2>Players</h2>

					<p>You have started this game</p>

					<h3>Players</h3>
					{% for player in game.players %}
					{{player.nickname()}}
					{% endfor %}

				</div>


				<div id="invitations" role="tabpanel" class="tab-pane">

					<h2>Invitations</h2>
					{% if not game.invited_emails %}
					<p>No-one has been invited yet</p>
					{% endif %}

					{% if game.invited_emails %}

					{% for email in game.invited_emails %}
					{{email}}
					{% endfor %}

					{% endif %}

					<form method="POST" action="/game/invite/player" role="form">
						<legend>Invite a new player</legend>
						<input type="hidden" name="game_key" value="{{game.key.urlsafe()}}">

						<div class="form-group">
							<label for="player-email">Player's email</label>
							<input type="email" class="form-control" id="player-email" name="email" required>
						</div>

						<button type="submit" class="btn btn-default">Invite</button>
					</form>

				</div>
				{% endif %}
			</div>
		</div>
	</div>

</div>
{% endblock %}
